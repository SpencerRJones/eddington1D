



PROGRAM run_eddington


USE defs_eddington
USE MonoRTM

IMPLICIT NONE


REAL :: hgt(nlevs)
REAL :: pres(nlevs)
REAL :: temp(nlevs)
REAL :: hum(nlyrs)
REAL :: sst
REAL :: wsp
!REAL :: N0_liq
!REAL :: mu_liq
!REAL :: N0_sn
!REAL :: rho_sn
REAL :: clwc(nlyrs)
REAL :: plwc(nlyrs)
REAL :: ciwc(nlyrs)
REAL :: piwc(nlyrs)
REAL :: salinity

REAL :: tbs(nchans)

INTEGER :: i

CHARACTER(LEN=100) :: lut_file

hgt(:) = (/(i, i=0, 15000, 500)/) / 1000.

pres(:) = (/ 1013.25, 954.608, 898.746, 845.560, 794.952,  &
              746.825, 701.085, 657.641, 616.402, 577.283, &
              540.199, 505.068, 471.810, 440.348, 410.607, &
              382.514, 355.998, 330.990, 307.425, 285.236, &
              264.363, 244.744, 226.321, 209.162, 193.304, &
              178.648, 165.104, 152.587, 141.018, 130.327, 121.446 /)

temp(:) = (/ 288.150, 284.900, 281.650, 278.400, 275.150,  &
             271.900, 268.650, 265.400, 262.150, 258.900,  &
             255.650, 252.400, 249.150, 245.900, 242.650,  &
             239.400, 236.150, 232.900, 229.650, 226.400,  &
             223.150, 219.900, 216.650, 216.650, 216.650,  &
             216.650, 216.650, 216.650, 216.650, 216.650, 216.650 /)


hum(:)  = (/ 6.9579005, 6.145043,  4.968144,  3.823435,  2.8937056, &
             2.2841082, 1.8709524, 1.5662655, 1.3235071, 1.1212766, &
             0.9476986, 0.81335336, 0.7126732, 0.62637424, 0.53833705, &
             0.4465204, 0.36552575, 0.29922277, 0.24146673, 0.19075373, &
             0.14964278, 0.117392, 0.09209186, 0.07239827, 0.05719715, &
             0.04531434, 0.03590021, 0.02844188,0.02253303,0.01785176 /)

clwc = (/ 0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0. /)

plwc = (/ 0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0. /)

ciwc = (/ 0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0. /)

piwc = (/ 0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0., &
          0., 0., 0., 0., 0., 0. /)

sst = 288.
wsp = 5.0

salinity = 35.0

IF (gas_abs .EQ. 0) THEN
        lut_file = 'LUT/MonoRTM_v5.3-GMI.tbl'
        CALL read_lut(lut_file)
ELSEIF (gas_abs .EQ. 1) THEN
        CONTINUE
ELSE
        WRITE(*,*) 'Error: gas absorption must be specified.'
        STOP
ENDIF


CALL eddington(frequency, polarization, incidence_angle, hgt, pres, temp, hum, clwc, plwc, &
                ciwc, piwc, sst, salinity, wsp, n0_liq, &
                mu_liq, n0_sn, rho_sn, tbs)

WRITE(*,*) 'Tbs: ', tbs


END PROGRAM run_eddington
